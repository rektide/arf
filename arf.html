<html>
<head>
<title>Abort Retry Fail</title>
<style>
body{
	--earth-tone: #70564a;
	--abort: #ab7a54;
	--retry: #89ad68;
	--fail: #ad6a68;
	margin: 8vh 8vw;
	font-family: "Fira Mono", Consolas, "SFMono-Regular", "Liberation Mono", Menlo, "Lucida Sans Typewriter", "Courier New", Courier, Monaco, monospace;
	font-size: 3vh;
}
div{
	padding-bottom: 0.9vh;
}
#abort{
	color: var(--abort);
}
#retry, #confirm{
	color: var(--retry);
}
#fail, #deny{
	color: var(--fail);
}
.hidden{
	display: none;
}
#confirm{
	padding-right: 3vh;
	font-size: 8vh;
}
#deny{
	font-size: 5.5vh;
}
#terminal {
	cursor: pointer;
	display: inline-block;
}
a:-webkit-any-link{
	color: unset;
}
.blink{
    animation:blinkingText 0.8s infinite;
}
@keyframes blinkingText{
    0%{   color: var(--text);}
    49%{  color: transparent;}
    50%{  color: transparent;}
    99%{  color: transparent;}
    100%{ color: var(--text)000;}
}
</style>
</head>

<body style="background-color: var(--earth-tone)" onkeydown="keyListen(event)">
<form id="offer" typeof="http://schema.org/Offer"/>
<input id="pendingAction" type="hidden"></input>

<div>
<span id="abort" class="option" property="potentialAction" typeof="http://arf.voodoowarez.com/AbortAction">
<span property="target">
	<a href="#abort" onclick="typeOut(this)" ontouchstart="typeOut(this)"
>abort</a>
</span>
</span>,

<span id="retry" class="option" property="potentialAction" typeof="http://arf.voodoowarez.com/RetryAction">
<span property="target">
	<a href="#retry" onclick="typeOut(this)" ontouchstart="typeOut(this)">retry</a>
</span>
</span>,

<span id="fail"  class="option" property="potentialAction" typeof="http://arf.voodoowarez.com/FailAction">
<span property="target">
	<a href="#fail" onclick="typeOut(this)" ontouchstart="typeOut(this)">fail</a>
</span>
</span>?
</div>

<div id="confirm" class="hidden"><span id="confirm">âœ”</span> <span id="deny">ðŸ—™</span></div>
<div>
$ <span id="terminal"></span><span class="blink">â–†</span>
</div>

<script defer>
const
  confirm= document.getElementById("confirm")
  terminal= document.getElementById("terminal")
function keyListen(evt){
	let key= event.key
	if( key=== "Enter"){
		return command()
	}
	// delete
	if(["ArrowLeft", "Delete", "Backspace"].indexOf( key)!== -1){
		terminal.textContent= terminal.textContent.slice(0, terminal.textContent.length- 1)
		return
	}
	if( key.length> 1){
		console.warn(`Not programmed to handle '${key}'`)
		return
	}
	// add text to buffer
	terminal.textContent= terminal.textContent+ key
}

function typeOut(el){
	let text= el.textContent
	function iterate(){
		setTimeout(function(){
			if(text.length){
				const next= text.substring( 0, 1)
				text= text.substring( 1)
				terminal.textContent= `${terminal.textContent}${next}`
				iterate() // loop again, with new random time
			}else{
				command()
			}
		}, 150 + (350 * Math.random()))
	}
	iterate()
}

const arf= ["abort", "retry", "fail"]
function command(){
	const
	  text= terminal.textContent,
	  match= arf.indexOf(text)
	  found= arf[ match]
	if(!found){
		const textNode= document.createElement("div")
		textNode.textContent= `Not found: ${text}`
		confirm.parentNode.insertBefore( textNode, confirm)
	}else{
	}
	terminal.textContent= ""
}
</script>
</body>
</html>
